"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[381],{179:function(t,e,s){var a=s(4836),i=s(5263);e.Z=void 0;var o=i(s(7294)),n=(0,a(s(2108)).default)(o.createElement("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}),"MyLocation");e.Z=n},4155:function(t,e,s){var a=s(4836),i=s(5263);e.Z=void 0;var o=i(s(7294)),n=(0,a(s(2108)).default)(o.createElement(o.Fragment,null,o.createElement("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zM7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9z"}),o.createElement("circle",{cx:"12",cy:"9",r:"2.5"})),"RoomOutlined");e.Z=n},7505:function(t,e,s){var a=s(5893),i=s(7294);let o=t=>{let{message:e,error:s=!1,className:o="",onClose:n=()=>console.log("close")}=t,[l,r]=i.useState(!1);return l?null:(0,a.jsxs)("div",{className:"status-message-container ".concat(s&&"error"," ").concat(o),children:[(0,a.jsx)("div",{className:"border"}),(0,a.jsxs)("div",{className:"content-message",children:[(0,a.jsx)("span",{children:e}),(0,a.jsx)("span",{onClick:()=>{r(!0),n()},children:"✕"})]})]})};o.defaultProps={message:"بروزرسانی با موفقیت انجام شد."},e.Z=o},5381:function(t,e,s){var a=s(4924),i=s(5893),o=s(7294),n=s(4155),l=s(179),r=s(6967),c=s(3722),h=s(7505);class d extends o.PureComponent{componentDidMount(){this.isInMapRange()}render(){var t,e,s,a,o;return console.log("state",this.state),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"app-location-container ".concat(this.props.extraContainerStyle),children:[(0,i.jsxs)("div",{className:this.state.locationState?"isExist"===this.state.locationState?"isexist":"isnotexist":"",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"input-container",children:[(0,i.jsx)(n.Z,{style:{color:"#6d6e71"}}),(0,i.jsx)("input",{onChange:t=>{this.handleSearch(t)},placeholder:"محله سعادت آباد - ویرایش",value:this.state.searchValue}),this.state.searchresult.length>0&&(0,i.jsx)("div",{className:"search-result",children:(0,i.jsx)("ul",{children:this.state.searchresult.map((t,e)=>(0,i.jsx)("li",{onClick:()=>{this.setState({...this.state,searchValue:t.address,searchresult:[],laoding:!0}),this.isExistInArea(t.geom.coordinates[1],t.geom.coordinates[0])},children:t.address},e))})})]}),(0,i.jsx)("div",{className:"find-location",onClick:()=>this.getUserLocation(),children:(0,i.jsx)(l.Z,{style:{fontSize:24}})})]}),(0,i.jsx)("div",{children:(0,i.jsx)(r.Z,{onClick:()=>{this.props.router.push({pathname:"/request"})},disabled:"notExist"===this.state.locationState||!this.state.locationState,type:"button",size:"lg app-btn-sm",theme:"primary",label:(null===this||void 0===this?void 0:null===(t=this.state)||void 0===t?void 0:t.loading)?"در حال بررسی ...":this.state.locationFetching?"در حال یافتن مکان شما...":this.state.locationState?"isExist"===this.state.locationState?"همین حالا درخواست سرویس دهید":"شما در محدوده ی سرویس نیستید":"بررسی  و درخواست سرویس"})})]}),(0,i.jsxs)("div",{className:this.state.locationState?"isExist"===this.state.locationState?"isexist ".concat((null===this||void 0===this?void 0:null===(e=this.props)||void 0===e?void 0:e.noBorder)&&"noBottomBorder"):"isnotexist":"",children:[(0,i.jsx)(r.Z,{onClick:()=>{this.props.router.push({pathname:"/request"})},disabled:"notExist"===this.state.locationState||!this.state.locationState,type:"button",size:"lg app-btn-sm",theme:"primary",label:(null===this||void 0===this?void 0:null===(s=this.state)||void 0===s?void 0:s.loading)?"در حال بررسی...":this.state.locationFetching?"در حال یافتن مکان شما...":this.state.locationState?"isExist"===this.state.locationState?"همین حالا درخواست سرویس دهید":"شما در محدوده ی سرویس نیستید":"بررسی  و درخواست سرویس"}),(0,i.jsx)("div",{className:"find-location",onClick:()=>this.getUserLocation(),children:(0,i.jsx)(l.Z,{style:{fontSize:32}})}),(0,i.jsxs)("div",{className:"input-container",children:[(0,i.jsx)(n.Z,{style:{color:"#6d6e71"}}),(0,i.jsx)("input",{onChange:t=>{this.handleSearch(t)},autocomplete:"off",id:"address",placeholder:"محله سعادت آباد - ویرایش",value:this.state.searchValue}),this.state.searchresult.length>0&&(0,i.jsx)("div",{className:"search-result",children:(0,i.jsx)("ul",{children:this.state.searchresult.map((t,e)=>(0,i.jsx)("li",{onClick:()=>{this.setState({...this.state,searchValue:t.address,searchresult:[],loading:!0}),this.isExistInArea(t.geom.coordinates[1],t.geom.coordinates[0])},children:t.address},e))})})]})]})]}),(null===this||void 0===this?void 0:null===(a=this.state)||void 0===a?void 0:null===(o=a.error)||void 0===o?void 0:o.length)!=0&&(0,i.jsx)(h.Z,{message:this.state.error,error:!0,className:"mapError",onClose:()=>{this.setState({...this.state,error:""})}})]})}constructor(...t){super(...t),(0,a.Z)(this,"state",{searchresult:[],locationFetching:!1,locationState:null,searchValue:"",loading:!1,error:""}),(0,a.Z)(this,"getUserLocation",()=>{if(this.setState({locationFetching:!0}),navigator.geolocation){let t=this;console.log("navigator",navigator),navigator.geolocation.getCurrentPosition(function(e){var s=e.coords.latitude,a=e.coords.longitude,i={lat:parseFloat(s),lng:parseFloat(a)};console.warn(i),t.setState({locationFetching:!1,error:""}),t.isExistInArea(i.lat,i.lng)},function(e){console.log("err==",e),console.warn("ERROR(".concat(e.code,"): ").concat(e.message)),t.setState({locationFetching:!1,error:null==e?void 0:e.message})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}else this.setState({locationFetching:!0,error:"مرورگر شما از موقعیت آدرس یابی خودکار پشتیبانی نمی کند."})}),(0,a.Z)(this,"handleSearch",t=>{null!=this._intervalId&&clearTimeout(this._intervalId);let{value:e}=t.target;this.setState({...this.state,searchValue:e,error:""}),(null==e?void 0:e.length)==0&&this.setState({locationState:null,locationFetching:!1,error:""}),this._intervalId=setTimeout(()=>{c.Z.mapAutosearch(e).then(t=>{this.setState({searchresult:t.data.value,loading:!1,error:""})}).catch(t=>{this.setState({searchresult:[],loading:!1,error:""})})},250)}),(0,a.Z)(this,"isInMapRange",()=>{var t=new FormData,e=new Blob([JSON.stringify({type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[51.429405,35.701359],[51.37825,35.700314],[51.378078,35.718852],[51.38134,35.724775],[51.379023,35.726099],[51.373186,35.727144],[51.367736,35.729234],[51.363616,35.728921],[51.361728,35.728189],[51.355376,35.72812],[51.352072,35.726656],[51.342244,35.726378],[51.338339,35.726691],[51.334734,35.726622],[51.332073,35.75097],[51.337395,35.766572],[51.337137,35.770681],[51.345463,35.771308],[51.343145,35.78043],[51.344004,35.782728],[51.346407,35.784329],[51.349411,35.784886],[51.353188,35.78426],[51.358852,35.783981],[51.363058,35.784747],[51.366491,35.786348],[51.368895,35.787602],[51.372414,35.788646],[51.376877,35.790665],[51.381254,35.791501],[51.38752,35.792963],[51.390095,35.792127],[51.390545,35.793067],[51.39238,35.794494],[51.393174,35.79459],[51.393592,35.79466],[51.394966,35.794999],[51.395921,35.795269],[51.397219,35.795121],[51.397905,35.79533],[51.397133,35.797697],[51.395856,35.800203],[51.39532,35.801752],[51.395448,35.8023],[51.396607,35.803518],[51.39783,35.804667],[51.39768,35.806068],[51.397401,35.806572],[51.396596,35.807007],[51.395953,35.807138],[51.395427,35.806981],[51.394998,35.806581],[51.394558,35.80632],[51.394333,35.806189],[51.394215,35.806111],[51.394215,35.806111],[51.393507,35.806189],[51.392112,35.806964],[51.389204,35.808591],[51.389011,35.809052],[51.389215,35.809583],[51.389612,35.809913],[51.390524,35.810522],[51.398549,35.813011],[51.402454,35.816839],[51.406317,35.815238],[51.410565,35.815899],[51.412711,35.816595],[51.413097,35.818231],[51.422968,35.822059],[51.425414,35.825538],[51.425543,35.830618],[51.426744,35.830897],[51.427088,35.828565],[51.426659,35.827591],[51.428161,35.824947],[51.430693,35.822859],[51.430864,35.820388],[51.431293,35.820353],[51.432753,35.822963],[51.434255,35.824181],[51.435928,35.824286],[51.436894,35.821049],[51.438611,35.820875],[51.438868,35.820319],[51.439812,35.81971],[51.441615,35.819449],[51.444404,35.819275],[51.446614,35.819223],[51.447258,35.818718],[51.447644,35.819414],[51.448503,35.818857],[51.448331,35.817256],[51.449093,35.817317],[51.449372,35.816639],[51.450069,35.816804],[51.450047,35.817239],[51.450756,35.817343],[51.451174,35.81857],[51.455637,35.819492],[51.456378,35.819188],[51.458684,35.82071],[51.458266,35.82151],[51.46053,35.824051],[51.462708,35.824355],[51.461978,35.826199],[51.460862,35.827835],[51.460948,35.829714],[51.463652,35.828148],[51.467428,35.827626],[51.469016,35.823868],[51.473866,35.82091],[51.47644,35.822511],[51.480088,35.821293],[51.480861,35.822198],[51.481891,35.821989],[51.481805,35.821223],[51.485281,35.819031],[51.487427,35.819205],[51.487856,35.820667],[51.489358,35.820875],[51.490645,35.823798],[51.491632,35.824007],[51.49159,35.821676],[51.492834,35.820701],[51.492963,35.820145],[51.491783,35.819379],[51.491268,35.818144],[51.4885,35.816595],[51.484487,35.816647],[51.484444,35.814699],[51.484938,35.812071],[51.48114,35.802865],[51.479745,35.799785],[51.474788,35.798897],[51.476827,35.793589],[51.477664,35.791588],[51.48468,35.788333],[51.480303,35.780987],[51.47717,35.778271],[51.476784,35.775486],[51.474252,35.77284],[51.470175,35.769602],[51.467042,35.764831],[51.465883,35.760931],[51.465454,35.756717],[51.465154,35.75097],[51.463995,35.745676],[51.460648,35.741079],[51.446743,35.742054],[51.44537,35.733694],[51.445134,35.731272],[51.445305,35.727824],[51.444147,35.725245],[51.44346,35.723277],[51.442537,35.720472],[51.441121,35.717911],[51.439383,35.715437],[51.437173,35.711726],[51.435413,35.708974],[51.433096,35.70589],[51.430242,35.701864],[51.430092,35.701777],[51.430092,35.701777],[51.430092,35.701777],[51.429427,35.701324],[51.429411,35.70135],[51.429405,35.701359]]]}}]})],{type:"application/geo+json"});t.append("polygons",e,"map.geojson"),c.Z.mapPostGeojson(t).then(t=>{console.log(t.data)}).catch(t=>{console.log(t)})}),(0,a.Z)(this,"isExistInArea",(t,e)=>{c.Z.mapIsLatLon(t,e).then(t=>{this.setState({locationState:"isExist",searchresult:[],loading:!1})}).catch(t=>{this.setState({locationState:"notExist",searchresult:[],loading:!1})})})}}e.Z=d}}]);